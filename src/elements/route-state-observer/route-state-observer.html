<!--
/**
 * @module Route Elements
 */
/**
 * route-state
 *
 * Example:
 *
 *     <route-state name="Sonos.CurrentTrack" value="{{current}}"></route-state>
 *
 * @class route-state
 */
-->
<link rel="import" href="../../components/polymer/polymer.html">

<polymer-element name="route-state-observer" attributes="name value model">
  <template></template>
  <script>
    Polymer('route-state-observer', {
      name: "default",
      value: null,
      attached: function() {
        this.listener = this.handleState.bind(this);
        this.model.addStateListener(this.name, this.listener);
      },
      detached: function() {
        console.log("DETACHED", this.name);
        this.model.removeStateListener(this.name, this.listener);
      },
      nameChanged: function(oldName, newName) {
        console.log("NAMECHANGED", oldName, newName);
        this.model.removeStateListener(oldName, this.listener);
        this.model.addStateListener(newName, this.listener);
      },
      handleState: function(value) {
        this.value = value;
        this.fire("state-change", this.value);
      },
    });
  </script>
</polymer-element>