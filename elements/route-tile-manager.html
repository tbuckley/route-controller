<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../components/polymer-flex-layout/polymer-flex-layout.html">
<link rel="import" href="./route-ui-tile/route-ui-tile.html">
<link rel="import" href="route-tile-media.html">
<link rel="import" href="route-tile-lights.html">

<polymer-element name="route-tile-manager" attributes="messenger">
  <template>
    <link rel="stylesheet" href="css/route-tile-manager.css">

    <polymer-flex-layout></polymer-flex-layout>
    <div flex>
      <polymer-flex-layout vertical></polymer-flex-layout>
      <div class="wrapper" flex>
        <route-ui-tile>
          <route-block-media messenger="{{messenger}}"></route-block-media>
        </route-ui-tile>
      </div>
      <div class="wrapper" flex>
        <route-ui-tile></route-ui-tile>
      </div>
    </div>
    <div flex>
      <polymer-flex-layout vertical></polymer-flex-layout>
      <div class="wrapper" flex>
        <route-ui-tile></route-ui-tile>
      </div>
      <div class="wrapper" flex>
        <route-ui-tile></route-ui-tile>
      </div>
    </div>
    <div flex>
      <polymer-flex-layout vertical></polymer-flex-layout>
      <div class="wrapper" flex>
        <route-ui-tile>
          <route-block-lights messenger="{{messenger}}" lights="(1|2)" name="lights"></route-block-lights>
        </route-ui-tile>
      </div>
      <div class="wrapper" flex>
        <route-ui-tile>
          <route-block-lights messenger="{{messenger}}" lights="(3)" name="lamp"></route-block-lights>
        </route-ui-tile>
      </div>
    </div>
  </template>
  <script>
    (function() {
      Polymer("route-tile-manager", {
        ready: function() {
          window.addEventListener("resize", this.screenSizeChange.bind(this));
          this.screenSizeChange();
        },
        enteredView: function() {},
        screenSizeChange: function(e) {
          var w = window.innerWidth - 32,
              h = window.innerHeight - 32,
              u = Math.floor(Math.min(w/3, h/2));
          console.log(w, h, u, this.$.tiles);
          this.style.width = u * 3 + "px";
          this.style.height = u * 2 + "px";
        },
      });
    })();
  </script>
</polymer-element>